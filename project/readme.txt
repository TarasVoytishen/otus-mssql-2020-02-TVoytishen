Расчет партий по FIFO для торговой компании

таблицы:

sales - продажи
incomes - поступления
outcomes - списания
parts - рассчитанные партии

данные поступают из учетной системы в реальном времени

